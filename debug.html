<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug Page</title>
    <style>
        body { font-family: sans-serif; margin: 2rem; }
        .success { color: green; }
        .error { color: red; }
        .test { margin-bottom: 1rem; padding: 0.5rem; border: 1px solid #ccc; }
    </style>
</head>
<body>
    <h1>Resource Loading Test Page</h1>
    <p>This page tests if we can load critical resources for the Financial Myths site</p>
    
    <div id="results"></div>

    <script>
        // Test resources
        const resources = [
            { name: "CSS file", url: "/FinancialMyths/css/styles.css", type: "css" },
            { name: "Main JS", url: "/FinancialMyths/js/main.js", type: "js" },
            { name: "Viz1 JS", url: "/FinancialMyths/js/visualizations/viz1.js", type: "js" },
            { name: "Viz1 Data", url: "/FinancialMyths/js/data/viz1_data.json", type: "json" }
        ];

        const resultsDiv = document.getElementById('results');

        // Test each resource
        function testResource(resource) {
            return new Promise((resolve, reject) => {
                const testDiv = document.createElement('div');
                testDiv.className = 'test';
                testDiv.innerHTML = `<h3>Testing: ${resource.name}</h3><p>URL: ${resource.url}</p><p id="status-${resources.indexOf(resource)}">Status: Testing...</p>`;
                resultsDiv.appendChild(testDiv);
                
                const statusElement = document.getElementById(`status-${resources.indexOf(resource)}`);
                
                if (resource.type === 'css') {
                    const link = document.createElement('link');
                    link.rel = 'stylesheet';
                    link.href = resource.url;
                    link.onload = () => {
                        statusElement.textContent = 'Status: SUCCESS!';
                        statusElement.className = 'success';
                        resolve(true);
                    };
                    link.onerror = () => {
                        statusElement.textContent = 'Status: FAILED!';
                        statusElement.className = 'error';
                        resolve(false);
                    };
                    document.head.appendChild(link);
                }
                else if (resource.type === 'js') {
                    const script = document.createElement('script');
                    script.src = resource.url;
                    script.onload = () => {
                        statusElement.textContent = 'Status: SUCCESS!';
                        statusElement.className = 'success';
                        resolve(true);
                    };
                    script.onerror = () => {
                        statusElement.textContent = 'Status: FAILED!';
                        statusElement.className = 'error';
                        resolve(false);
                    };
                    document.body.appendChild(script);
                }
                else if (resource.type === 'json') {
                    fetch(resource.url)
                        .then(response => {
                            if (!response.ok) {
                                throw new Error(`HTTP error! status: ${response.status}`);
                            }
                            return response.json();
                        })
                        .then(data => {
                            statusElement.textContent = 'Status: SUCCESS!';
                            statusElement.className = 'success';
                            
                            // Show sample of the data
                            const dataPreview = document.createElement('pre');
                            dataPreview.textContent = JSON.stringify(data, null, 2).substring(0, 300) + '...';
                            testDiv.appendChild(dataPreview);
                            
                            resolve(true);
                        })
                        .catch(error => {
                            statusElement.textContent = `Status: FAILED! ${error.message}`;
                            statusElement.className = 'error';
                            resolve(false);
                        });
                }
            });
        }

        // Run all tests sequentially
        async function runTests() {
            for (const resource of resources) {
                await testResource(resource);
            }
        }

        runTests();
    </script>
</body>
</html>